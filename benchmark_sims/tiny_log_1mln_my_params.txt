time elapsed: 108.9439 seconds

=================================

sim results:

Tiny Monte Carlo by Scott Prahl (https://omlc.org)
1 W Point Source Heating in Infinite Isotropic Scattering Medium

Scattering =   23.889/cm
Absorption =    0.370/cm
Photons    =  1000000

 Radius         Heat
[microns]     [W/cm^3]
     0     1.47048e+03
    83     2.72602e+02
   167     1.23472e+02
   250     7.51080e+01
   333     5.24278e+01
   417     3.95410e+01
   500     3.11648e+01
   583     2.53428e+01
   667     2.11910e+01
   750     1.80103e+01
   833     1.55185e+01
   917     1.34707e+01
  1000     1.18357e+01
  1083     1.04850e+01
  1167     9.32446e+00
  1250     8.37509e+00
  1333     7.52223e+00
  1417     6.79169e+00
  1500     6.14474e+00
  1583     5.58392e+00
  1667     5.08318e+00
  1750     4.64141e+00
  1833     4.24848e+00
  1917     3.88594e+00
  2000     3.57588e+00
  2083     3.28913e+00
  2167     3.03100e+00
  2250     2.79363e+00
  2333     2.58664e+00
  2417     2.39378e+00
  2500     2.21841e+00
  2583     2.05740e+00
  2667     1.91128e+00
  2750     1.77678e+00
  2833     1.65032e+00
  2917     1.53808e+00
  3000     1.43185e+00
  3083     1.33593e+00
  3167     1.24527e+00
  3250     1.16393e+00
  3333     1.08950e+00
  3417     1.01626e+00
  3500     9.51082e-01
  3583     8.91674e-01
  3667     8.34047e-01
  3750     7.80546e-01
  3833     7.31347e-01
  3917     6.87547e-01
  4000     6.43836e-01
  4083     6.03259e-01
  4167     5.66579e-01
  4250     5.32806e-01
  4333     5.01516e-01
  4417     4.70711e-01
  4500     4.42202e-01
  4583     4.16330e-01
  4667     3.91297e-01
  4750     3.67925e-01
  4833     3.47312e-01
  4917     3.26630e-01
  5000     3.08325e-01
  5083     2.90398e-01
  5167     2.73715e-01
  5250     2.58091e-01
  5333     2.43461e-01
  5417     2.29069e-01
  5500     2.16305e-01
  5583     2.04626e-01
  5667     1.92855e-01
  5750     1.81926e-01
  5833     1.71874e-01
  5917     1.62489e-01
  6000     1.53412e-01
  6083     1.45092e-01
  6167     1.37136e-01
  6250     1.29611e-01
  6333     1.22457e-01
  6417     1.15432e-01
  6500     1.09424e-01
  6583     1.03429e-01
  6667     9.79355e-02
  6750     9.27213e-02
  6833     8.76249e-02
  6917     8.28112e-02
  7000     7.82805e-02
  7083     7.42634e-02
  7167     7.03951e-02
  7250     6.66051e-02
  7333     6.30612e-02
  7417     5.97366e-02
  7500     5.66497e-02
  7583     5.35775e-02
  7667     5.06811e-02
  7750     4.80830e-02
  7833     4.56100e-02
  7917     4.32005e-02
  8000     4.09121e-02
  8083     3.88869e-02
  8167     3.68712e-02
  8250     3.49941e-02
  8333     3.31089e-02
  8417     3.15242e-02
  8500     2.98050e-02
  8583     2.82957e-02
  8667     2.68939e-02
  8750     2.54934e-02
  8833     2.41760e-02
  8917     2.29468e-02
  9000     2.17473e-02
  9083     2.05845e-02
  9167     1.95653e-02
  9250     1.86077e-02
  9333     1.76398e-02
  9417     1.67697e-02
  9500     1.59005e-02
  9583     1.50899e-02
  9667     1.42960e-02
  9750     1.35945e-02
  9833     1.29490e-02
  9917     1.23034e-02
 10000     1.16896e-02
 10083     1.10805e-02
 10167     1.05197e-02
 10250     9.98990e-03
 10333     9.52736e-03
 10417     9.05069e-03
 10500     8.57573e-03
 10583     8.14383e-03
 10667     7.78917e-03
 10750     7.39931e-03
 10833     7.00840e-03
 10917     6.66214e-03
 11000     6.33424e-03
 11083     6.02597e-03
 11167     5.73347e-03
 11250     5.43845e-03
 11333     5.19054e-03
 11417     4.93051e-03
 11500     4.69457e-03
 11583     4.46018e-03
 11667     4.23925e-03
 11750     4.03520e-03
 11833     3.83912e-03
 11917     3.65190e-03
 12000     3.47252e-03
 12083     3.30052e-03
 12167     3.15355e-03
 12250     2.99774e-03
 12333     2.84935e-03
 12417     2.70346e-03
 12500     2.57749e-03
 12583     2.45251e-03
 12667     2.33547e-03
 12750     2.22532e-03
 12833     2.11496e-03
 12917     2.01313e-03
 13000     1.91672e-03
 13083     1.83288e-03
 13167     1.73378e-03
 13250     1.65174e-03
 13333     1.56859e-03
 13417     1.49086e-03
 13500     1.42530e-03
 13583     1.35297e-03
 13667     1.28900e-03
 13750     1.22903e-03
 13833     1.17192e-03
 13917     1.11351e-03
 14000     1.06181e-03
 14083     1.00974e-03
 14167     9.61324e-04
 14250     9.19019e-04
 14333     8.71775e-04
 14417     8.32968e-04
 14500     7.98066e-04
 14583     7.58481e-04
 14667     7.19261e-04
 14750     6.87752e-04
 14833     6.53989e-04
 14917     6.22860e-04
 15000     5.93768e-04
 15083     5.65544e-04
 15167     5.39527e-04
 15250     5.13613e-04
 15333     4.88676e-04
 15417     4.64797e-04
 15500     4.41724e-04
 15583     4.22256e-04
 15667     4.00512e-04
 15750     3.84146e-04
 15833     3.65046e-04
 15917     3.49093e-04
 16000     3.30195e-04
 16083     3.14925e-04
 16167     3.01090e-04
 16250     2.89635e-04
 16333     2.73789e-04
 16417     2.61005e-04
 16500     2.47091e-04
 16583     2.36811e-04
 16667     2.25584e-04
 16750     2.15143e-04
 16833     2.04963e-04
 16917     1.96880e-04
 17000     1.85960e-04
 17083     1.77480e-04
 17167     1.69691e-04
 17250     1.61030e-04
 17333     1.53734e-04
 17417     1.46953e-04
 17500     1.39916e-04
 17583     1.33225e-04
 17667     1.26844e-04
 17750     1.20582e-04
 17833     1.14914e-04
 17917     1.10281e-04
 18000     1.04545e-04
 18083     9.97997e-05
 18167     9.56750e-05
 18250     9.11775e-05
 18333     8.63436e-05
 18417     8.20418e-05
 18500     7.79023e-05
 18583     7.43416e-05
 18667     7.17064e-05
 18750     6.82646e-05
 18833     6.45618e-05
 18917     6.23260e-05
 19000     5.89657e-05
 19083     5.62828e-05
 19167     5.44116e-05
 19250     5.13788e-05
 19333     4.89781e-05
 19417     4.67629e-05
 19500     4.46995e-05
 19583     4.24989e-05
 19667     4.06381e-05
 19750     3.84763e-05
 19833     3.71000e-05
 19917     3.52874e-05
 extra         0.00037


=================================

code that generated this simulation:

char   t1[80] = "Tiny Monte Carlo by Scott Prahl (https://omlc.org)";
char   t2[80] = "1 W Point Source Heating in Infinite Isotropic Scattering Medium";

#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#define SHELL_MAX  241

double mu_a = 0.37;			   /* Absorption Coefficient in 1/cm !!non-zero!! */
double mu_s = 23.88889;			   /* Reduced Scattering Coefficient in 1/cm */
double microns_per_shell = 83.3333333; /*  8.(3)e-7   Thickness of spherical shells in microns */
long   i, shell, photons = 1e6;
double x, y, z, u, v, w, weight;
double albedo, shells_per_mfp, xi1, xi2, t, heat[SHELL_MAX];

int main () 
{
	albedo = mu_s / (mu_s + mu_a);
	shells_per_mfp = 1e4/microns_per_shell/(mu_a+mu_s);
	
	for (i = 1; i <= photons; i++)
	{
		x = 0.0; y = 0.0; z = 0.0;					/*launch*/  
		u = 0.0; v = 0.0; w = 1.0;		
		weight = 1.0;
		
		for (;;) {
			t = -log((rand()+1.0)/(RAND_MAX+1.0));	/*move*/
			x += t * u;
			y += t * v;
			z += t * w;  

			shell=sqrt(x*x+y*y+z*z)*shells_per_mfp;	/*absorb*/
			if (shell > SHELL_MAX-1) shell = SHELL_MAX-1;	
			heat[shell] += (1.0-albedo)*weight;
			weight *= albedo;
		
			for(;;) {								/*new direction*/
				xi1=2.0*rand()/RAND_MAX - 1.0; 
				xi2=2.0*rand()/RAND_MAX - 1.0; 
				if ((t=xi1*xi1+xi2*xi2)<=1) break;
			}
			u = 2.0 * t - 1.0;
			v = xi1 * sqrt((1-u*u)/t);
			w = xi2 * sqrt((1-u*u)/t);
			
			if (weight < 0.001){ 					/*roulette*/
				if (rand() > 0.1 * RAND_MAX) break; 
				weight /= 0.1;
			}
		} 
	}	
	
	printf("%s\n%s\n\nScattering = %8.3f/cm\nAbsorption = %8.3f/cm\n",t1,t2,mu_s,mu_a);
	printf("Photons    = %8ld\n\n Radius         Heat\n[microns]     [W/cm^3]\n",photons);
	t = 4*3.14159*pow(microns_per_shell,3)*photons/1e12;
	for (i=0;i<SHELL_MAX-1;i++)
		printf("%6.0f    %12.5e\n",i*microns_per_shell, heat[i]/t/(i*i+i+1.0/3.0));
	printf(" extra    %12.5f\n",heat[SHELL_MAX-1]/photons);
	return 0;
}
