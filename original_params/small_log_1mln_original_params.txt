time elapsed: 26.5167 seconds

=================================

sim results:

Small Monte Carlo by Scott Prahl (https://omlc.org)
1 W/cm^2 Uniform Illumination of Semi-Infinite Medium

Scattering =   95.000/cm
Absorption =    5.000/cm
Anisotropy =    0.500
Refr Index =    1.500
Photons    =  1000000

Specular Refl      =    0.04000
Backscattered Refl =    0.21738

 Depth         Heat
[microns]     [W/cm^3]
     0     1.52972e+01 
    83     1.37283e+01 
   167     1.16371e+01 
   250     9.60172e+00 
   333     7.78822e+00 
   417     6.26484e+00 
   500     5.02095e+00 
   583     4.01571e+00 
   667     3.20709e+00 
   750     2.55335e+00 
   833     2.03368e+00 
   917     1.62408e+00 
  1000     1.29096e+00 
  1083     1.02623e+00 
  1167     8.16570e-01 
  1250     6.53534e-01 
  1333     5.20840e-01 
  1417     4.13781e-01 
  1500     3.30081e-01 
  1583     2.61284e-01 
  1667     2.09388e-01 
  1750     1.66650e-01 
  1833     1.32775e-01 
  1917     1.06387e-01 
  2000     8.42273e-02 
  2083     6.72321e-02 
  2167     5.38743e-02 
  2250     4.26724e-02 
  2333     3.37687e-02 
  2417     2.69293e-02 
  2500     2.14813e-02 
  2583     1.69938e-02 
  2667     1.34907e-02 
  2750     1.06764e-02 
  2833     8.37064e-03 
  2917     6.76563e-03 
  3000     5.41604e-03 
  3083     4.33760e-03 
  3167     3.43709e-03 
  3250     2.75633e-03 
  3333     2.18884e-03 
  3417     1.74204e-03 
  3500     1.38772e-03 
  3583     1.13457e-03 
  3667     8.95925e-04 
  3750     6.83576e-04 
  3833     5.59200e-04 
  3917     4.43752e-04 
  4000     3.53605e-04 
  4083     2.87749e-04 
  4167     2.26753e-04 
  4250     1.82855e-04 
  4333     1.50867e-04 
  4417     1.22960e-04 
  4500     9.46475e-05 
  4583     7.72629e-05 
  4667     6.25232e-05 
  4750     5.01145e-05 
  4833     4.16162e-05 
  4917     3.33510e-05 
  5000     2.30917e-05 
  5083     1.92762e-05 
  5167     1.63792e-05 
  5250     1.28184e-05 
  5333     9.52821e-06 
  5417     8.16584e-06 
  5500     6.40706e-06 
  5583     4.72484e-06 
  5667     4.34836e-06 
  5750     3.39482e-06 
  5833     2.99640e-06 
  5917     2.96177e-06 
  6000     1.59625e-06 
  6083     8.99817e-07 
  6167     4.55696e-07 
  6250     8.08835e-07 
  6333     2.25826e-07 
  6417     4.91972e-07 
  6500     3.19609e-07 
  6583     1.02004e-07 
  6667     8.98524e-08 
  6750     0.00000e+00 
  6833     6.41238e-08 
  6917     2.34618e-08 
  7000     6.11543e-08 
  7083     2.20024e-08 
  7167     0.00000e+00 
  7250     0.00000e+00 
  7333     0.00000e+00 
  7417     0.00000e+00 
  7500     0.00000e+00 
  7583     0.00000e+00 
  7667     0.00000e+00 
  7750     0.00000e+00 
  7833     0.00000e+00 
  7917     0.00000e+00 
  8000     0.00000e+00 
  8083     0.00000e+00 
  8167     0.00000e+00 
  8250     0.00000e+00 
  8333     0.00000e+00 
  8417     0.00000e+00 
  8500     0.00000e+00 
  8583     0.00000e+00 
  8667     0.00000e+00 
  8750     0.00000e+00 
  8833     0.00000e+00 
  8917     0.00000e+00 
  9000     0.00000e+00 
  9083     0.00000e+00 
  9167     0.00000e+00 
  9250     0.00000e+00 
  9333     0.00000e+00 
  9417     0.00000e+00 
  9500     0.00000e+00 
  9583     0.00000e+00 
  9667     0.00000e+00 
  9750     0.00000e+00 
  9833     0.00000e+00 
  9917     0.00000e+00 
 10000     0.00000e+00 
 10083     0.00000e+00 
 10167     0.00000e+00 
 10250     0.00000e+00 
 10333     0.00000e+00 
 10417     0.00000e+00 
 10500     0.00000e+00 
 10583     0.00000e+00 
 10667     0.00000e+00 
 10750     0.00000e+00 
 10833     0.00000e+00 
 10917     0.00000e+00 
 11000     0.00000e+00 
 11083     0.00000e+00 
 11167     0.00000e+00 
 11250     0.00000e+00 
 11333     0.00000e+00 
 11417     0.00000e+00 
 11500     0.00000e+00 
 11583     0.00000e+00 
 11667     0.00000e+00 
 11750     0.00000e+00 
 11833     0.00000e+00 
 11917     0.00000e+00 
 12000     0.00000e+00 
 12083     0.00000e+00 
 12167     0.00000e+00 
 12250     0.00000e+00 
 12333     0.00000e+00 
 12417     0.00000e+00 
 12500     0.00000e+00 
 12583     0.00000e+00 
 12667     0.00000e+00 
 12750     0.00000e+00 
 12833     0.00000e+00 
 12917     0.00000e+00 
 13000     0.00000e+00 
 13083     0.00000e+00 
 13167     0.00000e+00 
 13250     0.00000e+00 
 13333     0.00000e+00 
 13417     0.00000e+00 
 13500     0.00000e+00 
 13583     0.00000e+00 
 13667     0.00000e+00 
 13750     0.00000e+00 
 13833     0.00000e+00 
 13917     0.00000e+00 
 14000     0.00000e+00 
 14083     0.00000e+00 
 14167     0.00000e+00 
 14250     0.00000e+00 
 14333     0.00000e+00 
 14417     0.00000e+00 
 14500     0.00000e+00 
 14583     0.00000e+00 
 14667     0.00000e+00 
 14750     0.00000e+00 
 14833     0.00000e+00 
 14917     0.00000e+00 
 15000     0.00000e+00 
 15083     0.00000e+00 
 15167     0.00000e+00 
 15250     0.00000e+00 
 15333     0.00000e+00 
 15417     0.00000e+00 
 15500     0.00000e+00 
 15583     0.00000e+00 
 15667     0.00000e+00 
 15750     0.00000e+00 
 15833     0.00000e+00 
 15917     0.00000e+00 
 16000     0.00000e+00 
 16083     0.00000e+00 
 16167     0.00000e+00 
 16250     0.00000e+00 
 16333     0.00000e+00 
 16417     0.00000e+00 
 16500     0.00000e+00 
 16583     0.00000e+00 
 16667     0.00000e+00 
 16750     0.00000e+00 
 16833     0.00000e+00 
 16917     0.00000e+00 
 17000     0.00000e+00 
 17083     0.00000e+00 
 17167     0.00000e+00 
 17250     0.00000e+00 
 17333     0.00000e+00 
 17417     0.00000e+00 
 17500     0.00000e+00 
 17583     0.00000e+00 
 17667     0.00000e+00 
 17750     0.00000e+00 
 17833     0.00000e+00 
 17917     0.00000e+00 
 18000     0.00000e+00 
 18083     0.00000e+00 
 18167     0.00000e+00 
 18250     0.00000e+00 
 18333     0.00000e+00 
 18417     0.00000e+00 
 18500     0.00000e+00 
 18583     0.00000e+00 
 18667     0.00000e+00 
 18750     0.00000e+00 
 18833     0.00000e+00 
 18917     0.00000e+00 
 19000     0.00000e+00 
 19083     0.00000e+00 
 19167     0.00000e+00 
 19250     0.00000e+00 
 19333     0.00000e+00 
 19417     0.00000e+00 
 19500     0.00000e+00 
 19583     0.00000e+00 
 19667     0.00000e+00 
 19750     0.00000e+00 
 19833     0.00000e+00 
 19917     0.00000e+00 
 extra         0.00000


=================================

code that generated this simulation:

char   t1[80] = "Small Monte Carlo by Scott Prahl (https://omlc.org)";
char   t2[80] = "1 W/cm^2 Uniform Illumination of Semi-Infinite Medium";

#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#define BINS 241

double mu_a = 5;			/* Absorption Coefficient in 1/cm */
double mu_s = 95;			/* Scattering Coefficient in 1/cm */
double g = 0.5;				/* Scattering Anisotropy -1<=g<=1 */
double n = 1.5;				/* Index of refraction of medium */
double microns_per_bin = 83.3333333;/* Thickness of one bin layer */
long   i, photons = 1e6;
double x,y,z,u,v,w,weight;
double rs, rd, bit, albedo, crit_angle, bins_per_mfp, heat[BINS];

void launch() /* Start the photon */
{
	x = 0.0; y = 0.0; z = 0.0;		  
	u = 0.0; v = 0.0; w = 1.0;		
	weight = 1.0 - rs;
}

void bounce () /* Interact with top surface */
{
double t, temp, temp1,rf;
	w = -w;
	z = -z;
	if (w <= crit_angle) return;  			/* total internal reflection */	

	t       = sqrt(1.0-n*n*(1.0-w*w));    	/* cos of exit angle */
	temp1   = (w - n*t)/(w + n*t);
	temp    = (t - n*w)/(t + n*w);
	rf      = (temp1*temp1+temp*temp)/2.0;	/* Fresnel reflection */
	rd     += (1.0-rf) * weight;
	weight -= (1.0-rf) * weight;
}

void move() /* move to next scattering or absorption event */
{
double d = -log((rand()+1.0)/(RAND_MAX+1.0));
	x += d * u;
	y += d * v;
	z += d * w;  
	if ( z<=0 ) bounce();
}

void absorb () /* Absorb light in the medium */
{
int bin=z*bins_per_mfp;

	if (bin >= BINS) bin = BINS-1;	
	heat[bin] += (1.0-albedo)*weight;
	weight *= albedo;
	if (weight < 0.001){ /* Roulette */
		bit -= weight;
		if (rand() > 0.1*RAND_MAX) weight = 0; else weight /= 0.1;
		bit += weight;
	}
}

void scatter() /* Scatter photon and establish new direction */
{
double x1, x2, x3, t, mu;

	for(;;) {								/*new direction*/
		x1=2.0*rand()/RAND_MAX - 1.0; 
		x2=2.0*rand()/RAND_MAX - 1.0; 
		if ((x3=x1*x1+x2*x2)<=1) break;
	}	
	if (g==0) {  /* isotropic */
		u = 2.0 * x3 -1.0;
		v = x1 * sqrt((1-u*u)/x3);
		w = x2 * sqrt((1-u*u)/x3);
		return;
	} 

	mu = (1-g*g)/(1-g+2.0*g*rand()/RAND_MAX);
	mu = (1 + g*g-mu*mu)/2.0/g;
	if ( fabs(w) < 0.9 ) {	
		t = mu * u + sqrt((1-mu*mu)/(1-w*w)/x3) * (x1*u*w-x2*v);
		v = mu * v + sqrt((1-mu*mu)/(1-w*w)/x3) * (x1*v*w+x2*u);
		w = mu * w - sqrt((1-mu*mu)*(1-w*w)/x3) * x1;
	} else {
		t = mu * u + sqrt((1-mu*mu)/(1-v*v)/x3) * (x1*u*v + x2*w);
		w = mu * w + sqrt((1-mu*mu)/(1-v*v)/x3) * (x1*v*w - x2*u);
		v = mu * v - sqrt((1-mu*mu)*(1-v*v)/x3) * x1;
	}
	u = t;
}

void print_results() /* Print the results */
{
int i;
	printf("%s\n%s\n\nScattering = %8.3f/cm\nAbsorption = %8.3f/cm\n",t1,t2,mu_s,mu_a);
	printf("Anisotropy = %8.3f\nRefr Index = %8.3f\nPhotons    = %8ld",g,n,photons);
	printf("\n\nSpecular Refl      = %10.5f\nBackscattered Refl = %10.5f",rs,rd/(bit+photons));
	printf("\n\n Depth         Heat\n[microns]     [W/cm^3]\n");

	for (i=0;i<BINS-1;i++){
		printf("%6.0f    %12.5e \n",i*microns_per_bin, heat[i]/microns_per_bin*1e4/(bit+photons));
	}
	printf(" extra    %12.5f\n",heat[BINS-1]/(bit+photons));
}

int main ()
{
	albedo = mu_s / (mu_s + mu_a);
	rs = (n-1.0)*(n-1.0)/(n+1.0)/(n+1.0);	/* specular reflection */
	crit_angle = sqrt(1.0-1.0/n/n);			/* cos of critical angle */
	bins_per_mfp = 1e4/microns_per_bin/(mu_a+mu_s);
	
	for (i = 1; i <= photons; i++){
		launch ();
		while (weight > 0) {
			move ();
			absorb ();
			scatter ();
		}
	}	
	print_results();
	return 0;
}
