time elapsed: 16.6361 seconds

=================================

sim results:

Tiny Monte Carlo by Scott Prahl (https://omlc.org)
1 W Point Source Heating in Infinite Isotropic Scattering Medium

Scattering =   20.000/cm
Absorption =    2.000/cm
Photons    =  1000000

 Radius         Heat
[microns]     [W/cm^3]
     0     7.63606e+03
    83     1.30169e+03
   167     5.44829e+02
   250     3.07116e+02
   333     2.00356e+02
   417     1.40710e+02
   500     1.04321e+02
   583     8.02745e+01
   667     6.30863e+01
   750     5.05238e+01
   833     4.12765e+01
   917     3.39305e+01
  1000     2.83263e+01
  1083     2.36840e+01
  1167     2.00728e+01
  1250     1.70052e+01
  1333     1.45285e+01
  1417     1.24616e+01
  1500     1.07154e+01
  1583     9.25552e+00
  1667     8.02041e+00
  1750     6.96592e+00
  1833     6.06399e+00
  1917     5.30438e+00
  2000     4.62408e+00
  2083     4.04431e+00
  2167     3.54950e+00
  2250     3.12123e+00
  2333     2.73312e+00
  2417     2.40646e+00
  2500     2.12988e+00
  2583     1.88006e+00
  2667     1.65849e+00
  2750     1.47294e+00
  2833     1.30146e+00
  2917     1.15084e+00
  3000     1.01822e+00
  3083     9.07981e-01
  3167     8.06154e-01
  3250     7.15311e-01
  3333     6.35149e-01
  3417     5.66190e-01
  3500     5.01841e-01
  3583     4.48573e-01
  3667     4.00472e-01
  3750     3.56967e-01
  3833     3.17708e-01
  3917     2.84389e-01
  4000     2.53657e-01
  4083     2.26503e-01
  4167     2.03156e-01
  4250     1.81500e-01
  4333     1.62659e-01
  4417     1.45416e-01
  4500     1.30122e-01
  4583     1.15989e-01
  4667     1.04405e-01
  4750     9.33608e-02
  4833     8.41450e-02
  4917     7.50106e-02
  5000     6.74917e-02
  5083     6.03206e-02
  5167     5.42357e-02
  5250     4.86524e-02
  5333     4.39548e-02
  5417     3.91813e-02
  5500     3.50402e-02
  5583     3.14848e-02
  5667     2.82488e-02
  5750     2.53982e-02
  5833     2.28288e-02
  5917     2.05863e-02
  6000     1.84550e-02
  6083     1.67054e-02
  6167     1.50577e-02
  6250     1.35203e-02
  6333     1.22508e-02
  6417     1.08696e-02
  6500     9.88717e-03
  6583     8.78408e-03
  6667     7.99637e-03
  6750     7.15624e-03
  6833     6.46044e-03
  6917     5.83930e-03
  7000     5.26283e-03
  7083     4.72607e-03
  7167     4.25252e-03
  7250     3.81060e-03
  7333     3.42852e-03
  7417     3.12183e-03
  7500     2.81749e-03
  7583     2.53110e-03
  7667     2.29034e-03
  7750     2.06759e-03
  7833     1.87423e-03
  7917     1.70228e-03
  8000     1.51625e-03
  8083     1.36632e-03
  8167     1.22956e-03
  8250     1.11091e-03
  8333     1.00608e-03
  8417     9.02643e-04
  8500     8.21843e-04
  8583     7.44985e-04
  8667     6.76229e-04
  8750     6.00887e-04
  8833     5.46688e-04
  8917     4.93339e-04
  9000     4.40363e-04
  9083     4.09686e-04
  9167     3.60884e-04
  9250     3.25735e-04
  9333     2.98723e-04
  9417     2.68001e-04
  9500     2.41130e-04
  9583     2.17953e-04
  9667     1.97027e-04
  9750     1.76841e-04
  9833     1.63024e-04
  9917     1.43435e-04
 10000     1.29346e-04
 10083     1.18482e-04
 10167     1.05048e-04
 10250     9.49913e-05
 10333     8.59114e-05
 10417     8.03439e-05
 10500     6.99883e-05
 10583     6.30419e-05
 10667     5.59387e-05
 10750     5.30146e-05
 10833     4.68868e-05
 10917     4.33493e-05
 11000     3.86256e-05
 11083     3.60161e-05
 11167     3.22961e-05
 11250     2.92330e-05
 11333     2.60809e-05
 11417     2.37221e-05
 11500     2.13487e-05
 11583     1.95210e-05
 11667     1.66612e-05
 11750     1.56855e-05
 11833     1.38064e-05
 11917     1.28046e-05
 12000     1.18090e-05
 12083     1.00428e-05
 12167     9.78977e-06
 12250     8.23854e-06
 12333     7.90130e-06
 12417     7.30902e-06
 12500     6.74285e-06
 12583     5.94182e-06
 12667     5.60682e-06
 12750     5.05124e-06
 12833     4.33027e-06
 12917     4.03168e-06
 13000     3.79141e-06
 13083     3.25928e-06
 13167     3.00488e-06
 13250     2.75271e-06
 13333     2.50435e-06
 13417     2.17960e-06
 13500     2.12837e-06
 13583     1.92285e-06
 13667     1.61734e-06
 13750     1.43045e-06
 13833     1.42795e-06
 13917     1.15421e-06
 14000     1.06791e-06
 14083     9.88216e-07
 14167     9.04233e-07
 14250     7.81855e-07
 14333     7.28589e-07
 14417     6.59895e-07
 14500     6.34205e-07
 14583     5.49834e-07
 14667     5.02853e-07
 14750     4.43283e-07
 14833     4.61689e-07
 14917     3.64195e-07
 15000     3.02519e-07
 15083     2.95939e-07
 15167     2.75847e-07
 15250     2.22112e-07
 15333     2.48391e-07
 15417     2.00317e-07
 15500     1.64857e-07
 15583     1.44567e-07
 15667     1.57368e-07
 15750     1.47878e-07
 15833     1.14139e-07
 15917     6.28323e-08
 16000     9.05187e-08
 16083     8.67964e-08
 16167     8.34058e-08
 16250     6.72937e-08
 16333     6.76728e-08
 16417     4.27859e-08
 16500     4.62490e-08
 16583     3.98591e-08
 16667     3.47834e-08
 16750     3.62619e-08
 16833     1.80696e-08
 16917     2.26692e-08
 17000     3.08363e-08
 17083     2.74799e-08
 17167     1.83018e-08
 17250     2.73592e-08
 17333     2.83522e-08
 17417     1.35806e-08
 17500     1.09676e-08
 17583     9.01735e-09
 17667     7.22386e-09
 17750     5.84987e-09
 17833     1.39067e-08
 17917     1.20310e-08
 18000     8.11661e-09
 18083     8.35845e-09
 18167     1.78774e-08
 18250     5.55804e-09
 18333     8.95352e-09
 18417     7.12116e-09
 18500     2.67527e-09
 18583     3.11849e-09
 18667     3.10143e-09
 18750     3.66424e-09
 18833     3.04590e-09
 18917     4.83021e-09
 19000     1.34804e-09
 19083     3.40746e-10
 19167     0.00000e+00
 19250     0.00000e+00
 19333     1.11508e-09
 19417     7.48961e-10
 19500     2.33907e-09
 19583     0.00000e+00
 19667     1.16707e-09
 19750     3.13396e-10
 19833     5.39032e-10
 19917     4.16451e-10
 extra         0.00000


=================================

code that generated this simulation:

char   t1[80] = "Tiny Monte Carlo by Scott Prahl (https://omlc.org)";
char   t2[80] = "1 W Point Source Heating in Infinite Isotropic Scattering Medium";

#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#define SHELL_MAX  241

double mu_a = 2;			   /* Absorption Coefficient in 1/cm !!non-zero!! */
double mu_s = 20;			   /* Reduced Scattering Coefficient in 1/cm */
double microns_per_shell = 83.3333333; /* Thickness of spherical shells in microns */
long   i, shell, photons = 1e6;
double x, y, z, u, v, w, weight;
double albedo, shells_per_mfp, xi1, xi2, t, heat[SHELL_MAX];

int main () 
{
	albedo = mu_s / (mu_s + mu_a);
	shells_per_mfp = 1e4/microns_per_shell/(mu_a+mu_s);
	
	for (i = 1; i <= photons; i++)
	{
		x = 0.0; y = 0.0; z = 0.0;					/*launch*/  
		u = 0.0; v = 0.0; w = 1.0;		
		weight = 1.0;
		
		for (;;) {
			t = -log((rand()+1.0)/(RAND_MAX+1.0));	/*move*/
			x += t * u;
			y += t * v;
			z += t * w;  

			shell=sqrt(x*x+y*y+z*z)*shells_per_mfp;	/*absorb*/
			if (shell > SHELL_MAX-1) shell = SHELL_MAX-1;	
			heat[shell] += (1.0-albedo)*weight;
			weight *= albedo;
		
			for(;;) {								/*new direction*/
				xi1=2.0*rand()/RAND_MAX - 1.0; 
				xi2=2.0*rand()/RAND_MAX - 1.0; 
				if ((t=xi1*xi1+xi2*xi2)<=1) break;
			}
			u = 2.0 * t - 1.0;
			v = xi1 * sqrt((1-u*u)/t);
			w = xi2 * sqrt((1-u*u)/t);
			
			if (weight < 0.001){ 					/*roulette*/
				if (rand() > 0.1 * RAND_MAX) break; 
				weight /= 0.1;
			}
		} 
	}	
	
	printf("%s\n%s\n\nScattering = %8.3f/cm\nAbsorption = %8.3f/cm\n",t1,t2,mu_s,mu_a);
	printf("Photons    = %8ld\n\n Radius         Heat\n[microns]     [W/cm^3]\n",photons);
	t = 4*3.14159*pow(microns_per_shell,3)*photons/1e12;
	for (i=0;i<SHELL_MAX-1;i++)
		printf("%6.0f    %12.5e\n",i*microns_per_shell, heat[i]/t/(i*i+i+1.0/3.0));
	printf(" extra    %12.5f\n",heat[SHELL_MAX-1]/photons);
	return 0;
}
